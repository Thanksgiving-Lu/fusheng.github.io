<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pyhon3导出MySql数据库字典</title>
      <link href="/2022/07/29/exportMysqlDictionary/"/>
      <url>/2022/07/29/exportMysqlDictionary/</url>
      
        <content type="html"><![CDATA[<p>刚开始介入已经开发一段时间的项目，服务端开发人员总是要参考数据库来熟悉代码和整体流程。但是如果没有文档的话，熟悉起来比较慢，所以导出成md文件来方便我们熟悉项目。<br>python 需要修改数据库连接相关的配置，此脚本是按照数据库来进行导出的，</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> importlib<span class="token keyword">import</span> sys<span class="token keyword">import</span> pymysql<span class="token keyword">def</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    生成数据库字典表    """</span>    importlib<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>    <span class="token comment"># 使用前修改配置</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>        host<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>        port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>        user<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>        password<span class="token operator">=</span><span class="token string">''</span>    <span class="token punctuation">)</span>    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 使用前修改数据库名称</span>    database_name <span class="token operator">=</span> <span class="token string">''</span>    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>        <span class="token string">"SELECT TABLE_NAME, TABLE_COMMENT FROM information_schema.TABLES WHERE table_type='BASE TABLE' AND TABLE_SCHEMA='%s'"</span> <span class="token operator">%</span> database_name    <span class="token punctuation">)</span>    tables <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>    markdown_table_header <span class="token operator">=</span> <span class="token triple-quoted-string string">"""\n\n\n### %s (%s) \n| 序号 | 字段名称 | 数据类型 | 是否为空 | 字段说明 |\n| :--: |----| ---- | ---- | ---- |\n"""</span>    markdown_table_row <span class="token operator">=</span> <span class="token triple-quoted-string string">"""| %s | %s | %s | %s | %s |"""</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>database_name <span class="token operator">+</span> <span class="token string">'.md'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> table <span class="token keyword">in</span> tables<span class="token punctuation">:</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>            <span class="token string">"SELECT ORDINAL_POSITION, COLUMN_NAME, COLUMN_TYPE, IS_NULLABLE, COLUMN_COMMENT "</span>            <span class="token string">"FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='%s' AND TABLE_NAME='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>                database_name<span class="token punctuation">,</span> table<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token punctuation">)</span>        <span class="token punctuation">)</span>        tmp_table <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>        p <span class="token operator">=</span> markdown_table_header <span class="token operator">%</span> table        <span class="token keyword">for</span> col <span class="token keyword">in</span> tmp_table<span class="token punctuation">:</span>            p <span class="token operator">+=</span> markdown_table_row <span class="token operator">%</span> col <span class="token operator">+</span> <span class="token string">'\n'</span>        f<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>p<span class="token punctuation">)</span>        f<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    generate<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后md文档效果:<br><img src="https://fusheng-cloud.oss-cn-hangzhou.aliyuncs.com/blog/exportDemo.jpg" alt="avatar"></p>]]></content>
      
      
      <categories>
          
          <category> MySql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySql </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
